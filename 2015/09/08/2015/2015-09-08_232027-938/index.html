<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Dylan,2894220@qq.com"><title>阿里云 ubuntu-x64 python+django+mysql 开发环境搭建 · Dylan's blog</title><meta name="description" content="本文主要记录使用阿里云搭建 python+django+mysql 的开发环境，因为中间自己遇到了不少问题，整理了正确的步骤避免大家再碰壁而浪费时间。应该把精力花再更有价值的地方。
阿里云服务器已经预装好了 python2.7.6，所以我们无需再次安装  
1234root@aliyun:~# py"><meta name="keywords" content="Hexo,HTML,CSS,android,Linux"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 7.3.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">Dylan's blog</a></h3><div class="description"><p>To the pursuit of truth.</p></div></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="http://github.com/nmgwddj"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a target="_blank" rel="noopener" href="https://www.caicai.me"> CaiCai </a><span>&</span><a target="_blank" rel="noopener" href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/favicon.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>阿里云 ubuntu-x64 python+django+mysql 开发环境搭建</a></h3></div><div class="post-content"><p>本文主要记录使用阿里云搭建 python+django+mysql 的开发环境，因为中间自己遇到了不少问题，整理了正确的步骤避免大家再碰壁而浪费时间。应该把精力花再更有价值的地方。</p>
<p>阿里云服务器已经预装好了 python2.7.6，所以我们无需再次安装  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@aliyun:~<span class="comment"># python</span></span><br><span class="line">Python 2.7.6 (default, Mar 22 2014, 22:59:56) </span><br><span class="line">\[GCC 4.8.2\] on linux2</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br></pre></td></tr></table></figure>

<p>首先执行一下 apt-get update 命令来更新一下数据源，避免本地有些软件的地址是错误的导致安装过程中404错误。</p>
<p>mycode@aliyun:~$ sudo apt-get update</p>
<p>配置虚拟环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mycode@aliyun:~$ sudo apt-get install python-virtualenv</span><br><span class="line">mycode@aliyun:~$ sudo easy\_install virtualenvwrapper</span><br><span class="line">mycode@aliyun:~$ <span class="built_in">mkdir</span> <span class="variable">$HOME</span>/.virtualenvs</span><br><span class="line">mycode@aliyun:~$ <span class="built_in">echo</span> <span class="built_in">export</span> WORKON\_HOME=<span class="variable">$HOME</span>/.virtualenvs &gt;&gt; ~/.bashrc</span><br><span class="line">mycode@aliyun:~$ <span class="built_in">echo</span> <span class="built_in">source</span> /usr/local/bin/virtualenvwrapper.sh &gt;&gt; ~/.bashrc</span><br></pre></td></tr></table></figure>

<p>断开终端连接，使用相同用户重新登录，创建虚拟环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mycode@aliyun:~$ mkvirtualenv webchat</span><br><span class="line">New python executable <span class="keyword">in</span> webchat/bin/python</span><br><span class="line">Installing setuptools, pip...done.</span><br><span class="line">(webchat)mycode@aliyun:~$</span><br></pre></td></tr></table></figure>

<p>使用 <strong>mkvirtualenv [虚拟环境名称]</strong> 命令创建虚拟环境后，命令行会直接切换到 webchat 的虚拟环境，在这个虚拟环境中安装的软件需要使用 pip 命令，并且安装的软件并不会在真实系统中，要退出虚拟环境，使用 deactivate 命令，要删除虚拟环境，使用 rmvirtualenv 命令。</p>
<p>在安装 django 环境前，我们还需要安装几个必须的组件。</p>
<p>1、mysql-server</p>
<p>2、mysql-client</p>
<p>3、python-dev</p>
<p>4、libxml2-dev</p>
<p>5、libxslt-dev</p>
<p>6、zlib1g-dev</p>
<p>7、libmysqld-dev</p>
<p>8、<code>libjpeg-dev</code></p>
<p>9、libpcre3</p>
<p>10、libpcre3-dev</p>
<p>在非虚拟环境中，执行如下命令安装我们必备的组件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mycode@aliyun:~$ sudo apt-get install mysql-server mysql-client python-dev libxml2-dev libxslt-dev zlib1g-dev libmysqld-dev libjpeg-dev</span><br></pre></td></tr></table></figure>

<p>切换到虚拟环境中安装 django 所需的各种组件，这些组件不会被直接安装到系统，因为可能每个项目所需这些组件的版本号不同，所以只在虚拟环境中安装，执行如下命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(webchat)mycode@aliyun:~$ pip install Django ipdb ipython lxml MySQL-python Pillow wheel djangorestframework httplib2 requests uWSGI wechat-sdk</span><br></pre></td></tr></table></figure>

<p>创建新的 django 项目</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(webchat)mycode@aliyun:~$ django-admin startproject itcast\_webchat</span><br></pre></td></tr></table></figure>

<p>设置使用 mysql 数据库，进入django开发目录（itcast_webchat&#x2F;itcast_webchat&#x2F;settings.py），编辑 setting.py 配置文件，将如下内容注释</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#DATABASES = &#123;</span><br><span class="line"># &#x27;default&#x27;: &#123;</span><br><span class="line"># &#x27;ENGINE&#x27;: &#x27;django.db.backends.sqlite3&#x27;,</span><br><span class="line"># &#x27;NAME&#x27;: os.path.join(BASE\_DIR, &#x27;db.sqlite3&#x27;),</span><br><span class="line"># &#125;</span><br><span class="line">#&#125;</span><br></pre></td></tr></table></figure>

<p>添加 mysql 的设置信息，添加完成后会使用 mysql 数据库，要注意，里面设置的 dbname 必须存在，否则你生成数据表的时候会报错找不到这个数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DATABASES <span class="operator">=</span> &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.mysql&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: <span class="string">&#x27;dbname&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;USER&#x27;</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;PASSWORD&#x27;</span>: <span class="string">&#x27;password&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;HOST&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;PORT&#x27;</span>: <span class="string">&#x27;3306&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>生成相关数据表</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(webchat)mycode@aliyun:~$ <span class="built_in">cd</span> itcast\_webchat/</span><br><span class="line">(webchat)mycode@aliyun:~/itcast\_webchat$ python manage.py migrate</span><br><span class="line">Operations to perform:</span><br><span class="line">Apply all migrations: admin, contenttypes, auth, sessions</span><br><span class="line">Running migrations:</span><br><span class="line">Applying contenttypes.0001\_initial... OK</span><br><span class="line">Applying auth.0001\_initial... OK</span><br><span class="line">Applying admin.0001\_initial... OK</span><br><span class="line">Applying sessions.0001\_initial... OK</span><br></pre></td></tr></table></figure>

<p>启动 django 服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(webchat)mycode@aliyun:~/itcast\_webchat$ python manage.py runserver</span><br><span class="line">Performing system checks...</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">System check identified no issues (0 silenced).</span><br><span class="line">September 08, 2015 - 14:34:31</span><br><span class="line">Django version 1.7.8, using settings <span class="string">&#x27;itcast\_webchat.settings&#x27;</span></span><br><span class="line">Starting development server at http://127.0.0.1:8000/</span><br><span class="line">Quit the server with CONTROL-C.</span><br></pre></td></tr></table></figure>

<p>配置 django 关闭调试并设定可以让所有 IP 访问，进入django开发目录（itcast_webchat&#x2F;itcast_webchat&#x2F;settings.py），编辑 setting.py 配置文件，修改如下两个配置。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TEMPLATE\_DEBUG = False</span><br><span class="line">ALLOWED\_HOSTS = \[&#x27;\*&#x27;,\]</span><br></pre></td></tr></table></figure>

<p>安装 nginx-1.6.2，将 nginx-1.6.2 的压缩包上传到 linux 服务器或者直接从服务器上下载</p>
<p>解压 nginx 安装包</p>
<p>tar zxvf nginx-1.6.2.tar.gz</p>
<p>cd 进入解压后的 nginx 目录，安装所需组件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mycode@aliyun:/home/mycode/package/nginx-1.6.2$ sudo apt-get install libpcre3 libpcre3-dev</span><br><span class="line">mycode@aliyun:/home/mycode/package/nginx-1.6.2$ sudo apt-get install libssl-dev</span><br><span class="line">mycode@aliyun:/home/mycode/package/nginx-1.6.2$ sudo apt-get install openssl</span><br></pre></td></tr></table></figure>

<p>执行 nginx 目录下的 configure 执行文件，该文件有两个作用，一个是环境检查，另外一个是生成 makefile</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mycode@aliyun:/home/mycode/package/nginx-1.6.2$ ./configure</span><br></pre></td></tr></table></figure>

<p>编译并安装 nginx</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mycode@aliyun:/home/mycode/package/nginx-1.6.2$ make</span><br><span class="line">mycode@aliyun:/home/mycode/package/nginx-1.6.2$ sudo make install</span><br></pre></td></tr></table></figure>

<p>配置 nginx 反向代理，使用 VIM 编辑 &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;nginx.conf 文件，将如下行注释</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#location / &#123; </span><br><span class="line">#   root html; </span><br><span class="line">#   index index.html index.htm; </span><br><span class="line">#&#125;</span><br></pre></td></tr></table></figure>

<p>添加如下内容到被注释的文字后面，注意粗体标注的位置要改成你自己 django 启动时的地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    #Django address</span><br><span class="line">    proxy\_pass http://localhost:8000;</span><br><span class="line"></span><br><span class="line">    #Proxy Settings</span><br><span class="line">    proxy\_redirect off;</span><br><span class="line">    proxy\_set\_header Host $host;</span><br><span class="line">    proxy\_set\_header X-Real-IP $remote\_addr;</span><br><span class="line">    proxy\_set\_header X-Forwarded-For $proxy\_add\_x\_forwarded\_for;</span><br><span class="line">    proxy\_next\_upstream error timeout invalid\_header http\_500 http\_502 http\_503 http\_504;</span><br><span class="line">    proxy\_max\_temp\_file\_size 0;</span><br><span class="line">    proxy\_connect\_timeout 90;</span><br><span class="line">    proxy\_send\_timeout 90;</span><br><span class="line">    proxy\_read\_timeout 90;</span><br><span class="line">    proxy\_buffer\_size 4k;</span><br><span class="line">    proxy\_buffers 4 32k;</span><br><span class="line">    proxy\_busy\_buffers\_size 64k;</span><br><span class="line">    proxy\_temp\_file\_write\_size 64k;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>启动 nginx 服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mycode@aliyun:~$ /usr/local/nginx/sbin/nginx</span><br></pre></td></tr></table></figure>

<p>访问你阿里云的外网 IP 地址，如果你看到了 It worked! 就是成功了。</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2015-09-08</span><i class="fa fa-tag"></i><a class="tag" href="/categories/language/" title="language">language </a><a class="tag" href="/categories/platform/" title="platform">platform </a><a class="tag" href="/categories/platform/Linux-Unix/" title="Linux/Unix">Linux/Unix </a><a class="tag" href="/categories/language/Python/" title="Python">Python </a><a class="tag" href="/tags/django/" title="django">django </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,https://nmgwddj.github.io/2015/09/08/2015/2015-09-08_232027-938/,Dylan's blog,阿里云 ubuntu-x64 python+django+mysql 开发环境搭建,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2015/10/06/2015/2015-10-06_110343-954/" title="git community book 中文版">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2015/08/14/2015/2015-08-14_122401-895/" title="ASN.1 编码基础数据类型">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>