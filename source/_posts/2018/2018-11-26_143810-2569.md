---
title: 处理 Qt 中文提示 “常量中有换行符”
tags:
  - Qt
id: '2569'
categories:
  - - language
    - C/C++
  - - Language
date: 2018-11-26 14:38:10
---

在 Qt 自建的 Widget 窗口生成的 cpp 文件中，直接写中文编译时会提示错误。内容是 “常量中有换行符”。如下图所示： [![](/images/2018/11/2018-11-26_14-32-03.png)](/images/2018/11/2018-11-26_14-32-03.png)
<!-- more -->
要解决这个问题很简单，使用 notepad++ 打开你添加了中文的 cpp 文件，将编码转为 UTF8 编码（有 BOM 模式），如下所示： [![](/images/2018/11/2018-11-26_14-34-30.png)](/images/2018/11/2018-11-26_14-34-30.png) 这样再去编译的时候，一定不会再报错了，但是你会发现一个新的问题，就是编译出来的程序中文是乱码！ [![](/images/2018/11/2018-11-26_14-35-40.png)](/images/2018/11/2018-11-26_14-35-40.png) 解决这个问题也很简单，在你输入中文的地方，用 `QStringLiteral` 宏包裹一下就可以了，代码如下：

```
void MainWindow::on_showMessage_clicked()
{
    QMessageBox::information(nullptr, QStringLiteral("提示"), QStringLiteral("这是一个中文的提示，来测试是否有错误。"));
}
```

这样再编译出来的程序就不会乱码了。 [![](/images/2018/11/2018-11-26_14-37-44.png)](/images/2018/11/2018-11-26_14-37-44.png)

## 修改 Qt 默认设置让 UTF8 文件自动添加 BOM

为了让自己不用每次输入中文后都手动转换文件编码，可以设置 Qt 编辑器默认给 UTF8 格式无 BOM 的文档添加 BOM： [![](/images/2018/11/2018-11-26_14-45-32.png)](/images/2018/11/2018-11-26_14-45-32.png) 这样你就不用担心了，你可以随意输入中文在代码中，但记得要用 `QStringLiteral` 宏包裹一下。